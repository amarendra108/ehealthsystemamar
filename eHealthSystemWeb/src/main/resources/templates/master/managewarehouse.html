<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/master}">
<head>
<link rel="stylesheet" href="../assets/css/extend/style-extend.css">

<script>
function activeRoom(id,secId,rmId,rmCode,rmType,secCd,flrCd,fNo,sNo) {
	$(".roombtn").removeClass("roombtnactive");
	$("#"+id).addClass("roombtnactive");
	
	var rmName = $("#"+id).attr("rmname");
	
	$("#roomLevelText").text("");
	var roomLevelText = $("#locationCode").val();
	$("#roomLevelText").text(roomLevelText+"-"+flrCd+"-"+secCd+"-"+rmCode);
	
	$("#roomDBId").val("");
	$("#roomDBId").val(rmId);
	
	$("#sectionRoomId").val("");
	$("#sectionRoomId").val(secId);
	
	$("#roomCode").val("");
	$("#roomCode").val(rmCode);
	
	$("#roomName").val("");
	$("#roomName").val(rmName);
	
	$("#roomType").val("");
	$("#roomType").val(rmType);
	
	var dltattr = 'deleteRoom("'+rmId+'",'+fNo+','+sNo+')';
	$("#dltRoom").attr("onclick","");
	$("#dltRoom").attr("onclick",dltattr);
	
	var onclickattr = 'openNav("'+secId+'","'+secCd+'","'+flrCd+'");activeRoom("'+id+'","'+secId+'","'+rmId+'","'+rmCode+'","'+rmType+'","'+secCd+'","'+flrCd+'",'+fNo+','+sNo+');';
	$(".slidearrow").attr("onclick","");
	$(".slidearrow").attr("onclick",onclickattr);
}

	function openZoneNav(event) {
		closeNav();
		closeRackNav();
		var zoneNavText = $("#locationCode").text();

		$("#zoneNavText").text("");
		$("#zoneId").val("");
		$("#zoneCode").val("");
		$("#zoneDBVal").val("");
		$("#zoneName").val("");
		$("#zoneSlNoDBVal").val("");

		$("#zoneNavText").text(zoneNavText);
		document.getElementById("mySidenavZone").style.cssText = "width: 270px; position: absolute; right:-37px; overflow: hidden;";
		document.getElementById("main").style.width = "420px";
	}
	function openNav(secId,secCode,zoneCode) {
		
		closeRackNav();
		closeZoneNav(); 
		
		var roomLevelText = $("#locationCode").val();
		$("#roomLevelText").text("");
		$("#roomLevelText").text(roomLevelText+"-"+zoneCode+"-"+secCode);
		
		$("#sectionRoomId").val("");
		$("#roomDBId").val("");
		$("#roomCode").val("");
		$("#roomName").val("");
		$("#roomType").val("");
		$("#sectionRoomId").val(secId);
		
		document.getElementById("mySidenav").style.cssText = "width: 270px; position: absolute; right:-45px; overflow: hidden;";
		document.getElementById("main").style.width = "420px";
		
	}
	function closeNav() {
		$("#zoneRack").val("");
		$("#sectionRoomId").val("");
		document.getElementById("mySidenav").style.width = "0";
		document.getElementById("main").style.width = "480px";
	}
	
	function closeZoneNav() {
		 $("#zoneRack").val(""); 
		$("#zoneId").val("");
		$("#zoneDBVal").val("");
		$("#zoneName").val("");
		$("#zoneSlNoDBVal").val("");
		document.getElementById("mySidenavZone").style.width = "0";
		document.getElementById("main").style.width = "480px";
	}
	
	function openRackNav(code, zone) {

		 closeNav(); 
		closeZoneNav();
		
		$("#zoneRack").val("");
		$("#zoneRack").val(zone);
		var rackNavText = $("#locationCode").text();
		$("#rackNavText").text("");
		$("#rackId").val("");
		$("#rackDBVal").val("");
		$("#rackName").val("");
		$("#rackNavText").text(rackNavText + "-" + code);
		document.getElementById("mySidenavRack").style.cssText = "width: 270px; position: absolute; right:-37px; overflow: hidden;";
		document.getElementById("main").style.width = "420px";
	}

	function closeRackNav() {
		$("#rackId").val("");
		$("#RackDBVal").val("");
		$("#rackName").val("");
		document.getElementById("mySidenavRack").style.width = "0";
		document.getElementById("main").style.width = "480px";
		$("#zoneRack").val("");
	}
	
</script>

<script type="text/javascript">
	$(document).ready(function() {
		$("#ranking").click(function() {
			$('#myModal').modal('show');

		});
		
		
		$("input[class='myCheckbox']").click(function() {
			if ($("#formID input:checkbox:checked").length > 0) {

				$(".checkSubmit").addClass('active');
			} else {
				$(".checkSubmit").removeClass('active');
			}
		});
		//code for 1st + zone details
		//zone dataset start
		$("#zoneSave").click(function() {

			data = {};

			data.warehouseId = $("#warehouseId").val();
			data.zoneCode = $("#zoneId").val();
			data.zoneName = $("#zoneName").val();
			data.zoneId = $("#zoneDBVal").val();
			data.zoneSlNo = $("#zoneSlNoDBVal").val();
			$('.loader').show();
	    	$("body").addClass("overlay");
			submitZone(data);

		})
		//rack datset start
		$("#rackSave").click(function() {

			data = {};

			data.warehouseId = $("#warehouseId").val();
			data.rackName = $("#rackName").val();
			data.rackCode = $("#rackId").val();
			data.zoneId = $("#zoneRack").val();
			data.rackId = $("#rackDBVal").val();
			data.rackSlNo = $("#rackSerialNo").val();
			$('.loader').show();
	    	$("body").addClass("overlay");
	    	
			submitRack(data);

		})

		//zone dataset end here
		
			$("#roomSave").click(function(){
		
		data = {};
		
		data.roomId = $("#roomDBId").val();
		data.roomCode = $("#roomCode").val();
		data.roomName = $("#roomName").val();
		data.roomType = $("#roomType").val();
		data.rackId = $("#sectionRoomId").val();
		
		if(parseFloat($("#roomName").val().length) > 10) {
			checkCharLengthOfString("roomName", 10);
		} else {
			$('.loader').show();
	    	$("body").addClass("overlay");
			submitRoom(data);
		}
		
	})

	});//code for save a zone
	//code for edit zone
	function editFloor(i, id) {
		$("#zoneDBVal").val("");
		$("#zoneDBVal").val(id);
		//$("#zoneNavText").text("");

		var zoneNavText = $("#locationCode").text();
		 zoneNavText = zoneNavText + "-" + i; 
		 $("#zoneNavText").text("");
		$("#zoneNavText").text(zoneNavText);
		document.getElementById("mySidenavZone").style.cssText = "width: 270px; position: absolute; right:-37px; overflow: hidden;";
		document.getElementById("main").style.width = "420px";

		 closeRackNav();
		 closeNav(); 

		if (id) {
			$.ajax({
				type : "POST",
				url : "manage-warehouse-zone-edit",
				dataType : 'json',
				contentType : 'application/json',
				data : id,
				success : function(response) {
					if (response.message == "success") {
						console.log("edit", response.body)
						$("#zoneId").val(response.body.zoneCode);
						$("#zoneName").val(response.body.zoneName);
						$("#zoneSlNoDBVal").val(response.body.zoneSlNo);
					}
				},
				error : function(data) {
					console.log(data)
				}
			});
		}
	}
	///code for edit zone end
	function submitZone(dataset) {
		console.log(dataset)
		$.ajax({
					type : "POST",
					url : "manage-warehouse-zone-save",
					dataType : "json",
					contentType : "application/json",
					data : JSON.stringify(dataset),
					success : function(response) {
						if (response.message == "Success") {

							console.log(response.body)
			            	
							var tbl = '<li id="zoneLI_'+response.body.zoneSlNo+'"><span class="caret" id="spanRack_'
									+ response.body.zoneSlNo
									+ '" onclick=showRack("'
									+ response.body.zoneSlNo
									+ '") value="0"></span> <div class="cfloor" id="cbfloor_'+response.body.zoneSlNo+'"> <input type="checkbox" id="check2_'
									+ response.body.zoneSlNo
									+ '" class="pc1-box" onchange=checkSection(this,"'
									+ response.body.zoneSlNo
									+ '","'
									+ response.body.zoneCode
									+ '") checked="checked"> </div> <span class="leveltxt">'
									+ response.body.zoneCode
									+ ' - '
									+ response.body.zoneName
									+ ' </span><span id="floorCount_'+response.body.zoneSlNo+'" class="floor_counter"> (0) </span>'
									+ '<label for="check2">&nbsp;&nbsp;<a href="javascript:void(0)"><i title="Add Rack" class="ti-plus cbicon1 checkIcon2_'
									+ response.body.zoneSlNo
									+ '" id="" onclick=openRackNav("'
									+ response.body.zoneCode
									+ '","'
									+ response.body.zoneId
									+ '");></i></a>'
									+ '&nbsp;<a href="javascript:void(0)"><i title="Edit Zone" class="ti-pencil cbicon1 checkIcon2_'
									+ response.body.zoneSlNo
									+ '" id="" onclick=editFloor("'
									+ response.body.zoneCode
									+ '","'
									+ response.body.zoneId
									+ '");></i></a>&nbsp;<a href="javascript:void(0)"><i title="Delete zone" class="ti-close cbicon1 checkIcon2_'
									+ response.body.zoneSlNo
									+ '" id="" value="'
									+ response.body.zoneId
									+ '" id="removeFloor_'
									+ response.body.zoneSlNo
									+ '" onclick=removeFloor("'
									+ response.body.zoneSlNo
									+ '","'
									+ response.body.zoneId
									+ '");></i></a></label><ul class="nested" id="lastUl_'+response.body.zoneSlNo+'"></ul></li>';
									
							var zoneDBVal = $("#zoneDBVal").val();

							if (zoneDBVal) {
								console.log("edit done")
								openDetails(response.body.warehouseId);
							} else {
								console.log("add done")
								$("#liFloor").append(tbl);
								$(".checkIcon2_" + response.body.zoneSlNo)
										.addClass("green-cls");
								$(".checkIcon2_" + response.body.zoneSlNo)
										.removeClass("remove-green");
							}

							closeZoneNav();

							$('.loader').hide();
							$("body").removeClass("overlay");

						} else {
							$('.loader').hide();
							$("body").removeClass("overlay");
						}
					},
					error : function(data) {
						console.log(data);
						$('.loader').hide();
						$("body").removeClass("overlay");
					}
				})
	}
	//code for save zone is end
	//code for zone details end
	$(document)
			.ready(
					function() {
						$.fn
								.extend({
									treed : function(o) {

										/*var openedClass = 'fa-minus-circle';
										var closedClass = 'fa-plus-circle';*/
										var openedClass = 'fa fa-angle-down';
										var closedClass = 'fa fa-angle-right ';

										if (typeof o != 'undefined') {
											if (typeof o.openedClass != 'undefined') {
												openedClass = o.openedClass;
											}
											if (typeof o.closedClass != 'undefined') {
												closedClass = o.closedClass;
											}
										}
										;

										//initialize each of the top levels
										var tree = $(this);
										tree.addClass("tree");
										tree
												.find('li')
												.has("ul")
												.each(
														function() {
															var branch = $(this); //li with children ul
															branch
																	.prepend("<i class='indicator fa " + closedClass + "'></i>");
															branch
																	.addClass('branch');
															branch
																	.on(
																			'click',
																			function(
																					e) {
																				if (this == e.target) {
																					var icon = $(
																							this)
																							.children(
																									'i:first');
																					icon
																							.toggleClass(openedClass
																									+ " "
																									+ closedClass);
																					$(
																							this)
																							.children()
																							.children()
																							.toggle();
																				}
																			})
															branch.children()
																	.children()
																	.toggle();
														});

										//fire event from the dynamically added icon
										tree
												.find('.branch .indicator')
												.each(
														function() {
															$(this)
																	.on(
																			'click',
																			function() {
																				$(
																						this)
																						.closest(
																								'li')
																						.click();
																			});
														});

										//fire event to open branch if the li contains an anchor instead of text
										tree.find('.branch>a').each(function() {
											$(this).on('click', function(e) {
												$(this).closest('li').click();
												e.preventDefault();
											});
										});

										//fire event to open branch if the li contains a button instead of text
										tree
												.find('.branch>button')
												.each(
														function() {
															$(this)
																	.on(
																			'click',
																			function(
																					e) {
																				$(
																						this)
																						.closest(
																								'li')
																						.click();
																				e
																						.preventDefault();
																			});
														});
									}
								});

						$('#tree1').treed();

						$('#tree2').treed({
							openedClass : 'glyphicon-folder-open',
							closedClass : 'glyphicon-folder-close'
						});

						$('#tree3').treed({
							openedClass : 'glyphicon-chevron-right',
							closedClass : 'glyphicon-chevron-down'
						});
					})
</script>
<script type="text/javascript">
	$(document)
			.ready(
					function() {

						//select all checkbox
						$(".pc-box").click(
								function() {
									if (this.checked) {
										$(this).closest("li").find(".pc-box")
												.prop("checked", true);
										$(this).closest("li").find(".pc1-box")
												.prop("checked", true);
										$(this).closest("li").find(".pc2-box")
												.prop("checked", true);
										$(this).closest("li").find(
												".activityCls").prop("checked",
												true);
										$(this).parent();
									}
								});
						$(".pc-box").click(
								function() {
									if (!this.checked) {
										$(this).closest("li").find(".pc1-box")
												.prop("checked", false);
										$(this).closest("li").find(".pc2-box")
												.prop("checked", false);
										$(this).closest("li").find(
												".activityCls").prop("checked",
												false);
										$(this).parent();
									}
								});
						$(".pc1-box").click(
								function() {
									if (this.checked) {
										$(this).closest("li").find(".pc1-box")
												.prop("checked", true);
										$(this).closest("li").find(".pc2-box")
												.prop("checked", true);
										$(this).closest("li").find(
												".activityCls").prop("checked",
												true);
										$(this).parent();
									}
								});
						$(".pc1-box").click(
								function() {
									if (!this.checked) {
										$(this).closest("li").find(".pc2-box")
												.prop("checked", false);
										$(this).closest("li").find(
												".activityCls").prop("checked",
												false);
										$(this).parent();
									}
								});

						$(".pc2-box").click(
								function() {
									if (this.checked) {
										$(this).closest("li").find(".pc2-box")
												.prop("checked", true);
										$(this).closest("li").find(
												".activityCls").prop("checked",
												true);
										$(this).parent();
									}
								});
						$(".pc2-box").click(
								function() {
									if (!this.checked) {
										$(this).closest("li").find(
												".activityCls").prop("checked",
												false);
										$(this).parent();
									}
								});

						$(".activityCls").click(
								function() {
									if (!this.checked)
										$(this).closest("ul").prev().find(
												".pc-box").prop("checked",
												false);
								});
						//select all checkbox end

						//SELECT BOX CUSTOM
						jQuery(document)
								.delegate(
										'a.add-record',
										'click',
										function(e) {
											e.preventDefault();
											var content = jQuery('#append_table tr'), size = jQuery('#myTbl >tbody >tr').length + 1, element = null, element = content
													.clone();
											element.attr('id', 'rec-' + size);
											element.find('.delete-record')
													.attr('data-id', size);
											element.appendTo('#myTbl_body');
											element.find('.sn').html(size);
										});
						jQuery(document)
								.delegate(
										'a.delete-record',
										'click',
										function(e) {
											e.preventDefault();
											var didConfirm = confirm("Are you sure You want to delete");
											if (didConfirm == true) {
												var id = jQuery(this).attr(
														'data-id');
												var targetDiv = jQuery(this)
														.attr('targetDiv');
												jQuery('#rec-' + id).remove();

												//regnerate index number on table
												$('#myTbl_body tr')
														.each(
																function(index) {
																	$(this)
																			.find(
																					'span.sn')
																			.html(
																					index + 1);
																});
												return true;
											} else {
												return false;
											}

											$('#closeKey').on('click',
													function() {
														alert()
													});
										});

						$('input,textarea').focus(
								function() {
									$(this).data('placeholder',
											$(this).attr('placeholder')).attr(
											'placeholder', '');
								}).blur(
								function() {
									$(this).attr('placeholder',
											$(this).data('placeholder'));
								});

						//New Friday

						var x, i, j, l, ll, selElmnt, a, b, c;
						/*look for any elements with the class "custom-select":*/
						x = document.getElementsByClassName("selectbox");
						l = x.length;
						for (i = 0; i < l; i++) {
							selElmnt = x[i].getElementsByTagName("select")[0];
							ll = selElmnt.length;
							/*for each element, create a new DIV that will act as the selected item:*/
							a = document.createElement("DIV");
							a.setAttribute("class", "select-selected");
							a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
							x[i].appendChild(a);
							/*for each element, create a new DIV that will contain the option list:*/
							b = document.createElement("DIV");
							b.setAttribute("class", "select-items select-hide");
							for (j = 1; j < ll; j++) {
								/*for each option in the original select element,
								create a new DIV that will act as an option item:*/
								c = document.createElement("DIV");
								c.innerHTML = selElmnt.options[j].innerHTML;
								c
										.addEventListener(
												"click",
												function(e) {
													/*when an item is clicked, update the original select box,
													and the selected item:*/
													var y, i, k, s, h, sl, yl;
													s = this.parentNode.parentNode
															.getElementsByTagName("select")[0];
													sl = s.length;
													h = this.parentNode.previousSibling;
													for (i = 0; i < sl; i++) {
														if (s.options[i].innerHTML == this.innerHTML) {
															s.selectedIndex = i;
															h.innerHTML = this.innerHTML;
															y = this.parentNode
																	.getElementsByClassName("same-as-selected");
															yl = y.length;
															for (k = 0; k < yl; k++) {
																y[k]
																		.removeAttribute("class");
															}
															this
																	.setAttribute(
																			"class",
																			"same-as-selected");
															break;
														}
													}
													h.click();
												});
								b.appendChild(c);
							}
							x[i].appendChild(b);
							a.addEventListener("click", function(e) {
								/*when the select box is clicked, close any other select boxes,
								and open/close the current select box:*/
								e.stopPropagation();
								closeAllSelect(this);
								this.nextSibling.classList
										.toggle("select-hide");
								this.classList.toggle("select-arrow-active");
							});
						}

						function closeAllSelect(elmnt) {
							/*a function that will close all select boxes in the document,
							except the current select box:*/
							var x, y, i, xl, yl, arrNo = [];
							x = document.getElementsByClassName("select-items");
							y = document
									.getElementsByClassName("select-selected");
							xl = x.length;
							yl = y.length;
							for (i = 0; i < yl; i++) {
								if (elmnt == y[i]) {
									arrNo.push(i)
								} else {
									y[i].classList
											.remove("select-arrow-active");
								}
							}
							for (i = 0; i < xl; i++) {
								if (arrNo.indexOf(i)) {
									x[i].classList.add("select-hide");
								}
							}
						}
						/*if the user clicks anywhere outside the select box,
						then close all select boxes:*/
						document.addEventListener("click", closeAllSelect);
						//SELECT BOX CUSTOM ENDS

						$("#newBtn").click(function() {
							$("#myTbl").hide();
							$(".btn-hs").hide();
							$("#demo").show();
						})

	$(".pc-box").click(function() {
	    if (this.checked) {
	    	$(".cbicon").addClass("green-cls");
	    	$(".cbicon1").addClass("green-cls");
			$(".cbicon2").addClass("green-cls");
			$(".cbicon").removeClass("remove-green");
	    	$(".cbicon1").removeClass("remove-green");
			$(".cbicon2").removeClass("remove-green");
	        $(this).closest("li").find(".pc-box").prop("checked", true);
	        $(this).closest("li").find(".pc1-box").prop("checked", true);
	        $(this).closest("li").find(".pc2-box").prop("checked", true);
	        $(this).parent();
	        $(".roomLoc").show();
	        
	        showRoomDetails("ABC");
	    }
	    if (!this.checked) {
	    	$(".cbicon").removeClass("green-cls");
	    	$(".cbicon1").removeClass("green-cls");
			$(".cbicon2").removeClass("green-cls");
			$(".cbicon").addClass("remove-green");
	    	$(".cbicon1").addClass("remove-green");
			$(".cbicon2").addClass("remove-green");
	        $(this).closest("li").find(".pc1-box").prop("checked", false);
	        $(this).closest("li").find(".pc2-box").prop("checked", false);
	        $(this).parent();
	        $(".roomLoc").hide();
	        //$("#locCount").text(' (0)');
	    }
	});
	
						

					$("#cancelBtn").click(function() {
						$("#myGrid").show();
						$(".btn-hs").show();
						$("#demo").hide();
						
						//listingOfLocation();
						
						$(".caret").removeClass("caret-down");
						$(".nested").removeClass("active");
						
						$('input:checkbox').prop('checked',false);
						
						$("#searchRowDiv").show();
						
						
					});
					
					$("input[class='myCheckbox']").click(function() {
						if ($("#formID input:checkbox:checked").length > 0) {

							$(".checkSubmit").addClass('active');
						} else {
							$(".checkSubmit").removeClass('active');
						}
					});					
						
						$("#saveLocation").click(
								function() {

									data = {};

									data.locationId = $("#locationId").val();
									data.locationName = $("#locationName")
											.val();
									data.locationCode = $("#locationCode")
											.val();
									data.locationType = $("#locationType")
											.val();
									data.locCountry = $("#locCountry").val();
									data.locState = $("#locState").val();
									data.locCity = $("#locCity").val();
									data.locStreet = $("#locStreet").val();
									data.locVirtual = $(
											"input[name='isVirtual']:checked")
											.val();
									data.locStatus = $(
											"input[name='isActive']:checked")
											.val();

									submitLocation(data);

								})
						//code for delete zone
						$("#deleteModalBtn").click(function(){
							 data = $("#deleteModalBtn").attr("value");
							var slNo = $("#deleteModalBtn").attr("slNo");
							var deleteData = $("#deleteModalBtn").attr("deleteData");
							var fSlNo = $("#deleteModalBtn").attr("zoneSlNo");
							$("#deleteModalBtn").attr("disabled","disabled");
											if (data) {
												if(deleteData == "1") {
													
												$.ajax({
															type : "POST",
															url : "manage-warehouse-zone-delete",
															dataType : 'json',
															contentType : 'application/json',
															data : data,
															success : function(response) {
																console.log("sucesssss delete")
																if (response.message == "success") {
																	var floorCount = $("#floorCount_"+slNo).text();
												                	floorCount = floorCount.trim();
												                	floorCount = floorCount.replace("(","");
												                	floorCount = floorCount.replace(")","");
																	
																	var loccount = $("#locCount").text();
												                	loccount = loccount.trim();
												                	loccount = loccount.replace("(","");
												                	loccount = loccount.replace(")","");
												                	
												                	loccount = parseFloat(loccount) - parseFloat(floorCount);
												                	
												                	$("#locCount").text(" ("+loccount+")");
												                	
																	$("#zoneLI_"+slNo).remove();
																	
																	cancelModalBtn();
																	
																	$("#delete").modal('hide');
															

																	closeZoneNav();
																	showRoomDetails(data);
																}
															},
															error : function(
																	data) {
																console.log(data)
															}
														});
											}else if(deleteData == "2") {
												
												$.ajax({
													type : "POST",
													url : "manage-warehouse-rack-delete",
													dataType : 'json',
													contentType : 'application/json',
													data : data,
													success : function(response) {
														console.log("sucesssss delete rack")
														if (response.message == "success") {
															$("#deleteModalBtn").removeAttr("disabled");
															
															var sectionCount = $("#sectionCount_"+fSlNo+"_"+slNo).text();
										                	sectionCount = sectionCount.trim();
										                	sectionCount = sectionCount.replace("(","");
										                	sectionCount = sectionCount.replace(")","");
															
															var loccount = $("#locCount").text();
										                	loccount = loccount.trim();
										                	loccount = loccount.replace("(","");
										                	loccount = loccount.replace(")","");
										                	
										                	loccount = parseFloat(loccount) - parseFloat(sectionCount);
										                	
										                	$("#locCount").text(" ("+loccount+")");
										                	
										                	var floorCount = $("#floorCount_"+fSlNo).text();
										                	floorCount = floorCount.trim();
										                	floorCount = floorCount.replace("(","");
										                	floorCount = floorCount.replace(")","");
										                	
										                	floorCount = parseFloat(floorCount) - parseFloat(sectionCount);
										                	
										                	$("#floorCount_"+fSlNo).text(" ("+floorCount+")");
										                	
															$("#rackLI_"+fSlNo+"_"+slNo).remove();
															
															cancelModalBtn();
															
															$("#delete").modal('hide');
															
															closeRackNav();
															
															showRoomDetails(data);
															
														}
													}, error : function(data) {
														console.log(data)
													}
												});
											} else if(deleteData == "3") {
												
												$.ajax({
													type : "POST",
													url : "manage-warehouse-room-delete",
													dataType : 'json',
													contentType : 'application/json',
													data : data,
													success : function(response) {
														if (response.message == "success") {
															$("#deleteModalBtn").removeAttr("disabled");
															
															var loccount = $("#locCount").text();
										                	loccount = loccount.trim();
										                	loccount = loccount.replace("(","");
										                	loccount = loccount.replace(")","");
										                	
										                	loccount = parseFloat(loccount) - 1;
										                	
										                	$("#locCount").text(" ("+loccount+")");
										                	
										                	var floorCount = $("#floorCount_"+fSlNo).text();
										                	floorCount = floorCount.trim();
										                	floorCount = floorCount.replace("(","");
										                	floorCount = floorCount.replace(")","");
										                	
										                	floorCount = parseFloat(floorCount) - 1;
										                	
										                	$("#floorCount_"+fSlNo).text(" ("+floorCount+")");
										                	
										                	var sectionCount = $("#sectionCount_"+fSlNo+"_"+slNo).text();
										                	sectionCount = sectionCount.trim();
										                	sectionCount = sectionCount.replace("(","");
										                	sectionCount = sectionCount.replace(")","");
										                	
										                	sectionCount = parseFloat(sectionCount) - 1;
										                	
										                	$("#sectionCount_"+fSlNo+"_"+slNo).text(" ("+sectionCount+")");
															
															cancelModalBtn();
															
															$("#delete").modal('hide');
															
															closeNav();
															
															showRoomDetails(data);
														}
													}, error : function(data) {
														console.log(data)
													}
												});
											} else {
												$("#deleteModalBtn").removeAttr("disabled");
												$("#delete").modal('hide');
											}
											}
										})
					});

	function cancelBar() {
		var id = document.getElementById("closeKey");
		id.style.display = "block";
		if ($('#searchBar').val() == null || $('#searchBar').val() == "") {
			id.style.display = "none";
		}
	}
</script>
<script>
	$(document).ready(
			function() {
				var toggler = document.getElementsByClassName("caret");
				var i;

				for (i = 0; i < toggler.length; i++) {
					toggler[i].addEventListener("click", function() {
						this.parentElement.querySelector(".nested").classList
								.toggle("active");
						this.classList.toggle("caret-down");
					});
				}
			});
	
	function openDetails(id) {
	
		if (id == "warehouseId") {
			
			var warehouseId = $('#' + id).val();
		} else {
			var warehouseId = id;
		}
		
		$('.loader').show();
		$("body").addClass("overlay");
		
		$("#liFloor").empty();
		$("#check1").prop("checked",true);
		
		$(".cbicon").addClass("green-cls");
		
		if (warehouseId) {
			
			$.ajax({
				type : "POST",
				url : "manage-warehouse-get-location",
				dataType : 'json',
				contentType : 'application/json',
				data : warehouseId,
				success : function(response) {
					
					if (response.message == "success") {
						console.log(response);
						$("#locationId").empty();
						$("#locationCode").empty();

						$("#locationId").text(response.body[0].locationId);
						$("#locationCode").text(response.body[0].locationCode);
						
						$("#myUL").show();
						
						
						$("#warehouseDetailsId").text("");
						var labeltxt = response.body[0].locationCode + " - " + response.body[0].locationName;
						$("#warehouseDetailsId").text(labeltxt);
						//$("#locCount").text(' ('+response.body.locCount+')');
							
						
						$('.loader').hide();
				    	$("body").removeClass("overlay");

					}
				},
				error : function(data) {
					console.log(data);
					$("#warehouseId").empty();

					$("#locationCode").empty();
					$("#myUL").hide();
					
					$("#locCount").text(' (0)');
				}
			})
			$.ajax({
						type : "POST",
						url : "manage-warehouse-get-warehouse-zone-details",
						dataType : 'json',
						contentType : 'application/json',
						data : warehouseId,
						success : function(response) {
							if (response.message == "success") {
								
								console.log(response);
								
								if(response.body.length <= 0) {
									$(".slidearrow").hide();
								} else {
									
									$(".slidearrow").show();
								}
								
								for (var i = 0; i < response.body.length; i++) {
									 //alert( i < response.body.length)
									 if(response.body[i].sectionList.length <= 0) {	
										//alert("if"+response.body[i].sectionList.length)
											$(".slidearrow").hide();
										} else {
											//alert("else"+response.body[i].sectionList.length)
											$(".slidearrow").show();
										} 
								
									var div = "";
										if (response.body[i].sectionList.length > 0) {
											
											for (var j = 0; j < response.body[i].sectionList.length; j++) {
												
												div = div
														+ '<li id="rackLI_'+response.body[i].zoneSlNo+'_'+response.body[i].sectionList[j].rackSlNo+'"><span class="caret-remove"></span><input type="checkbox" id="sectionChkBox" name="check_'
														+ response.body[i].zoneSlNo
														+ '_'
														+ response.body[i].sectionList[j].rackSlNo
														+ '" onchange=checkSec(this,"'
														+ response.body[i].zoneSlNo
														+ '","'
														+ response.body[i].sectionList[j].rackSlNo
														+ '","'
														+ response.body[i].sectionList[j].rackCode
														+ '") class="pc2-box check_'
														+ response.body[i].zoneSlNo
														+ '" checked="checked" data-sec="'
														+ response.body[i].sectionList[j].rackId
														+ '" data-floor="'
														+ response.body[i].sectionList[j].zoneId
														+ '" data-loc="'
														+ response.body[i].sectionList[j].warehouseId
														+ '"> <span class="leveltxt">'
														+ response.body[i].sectionList[j].rackCode
														+ ' - '
														+ response.body[i].sectionList[j].rackName
														+ ' </span> <span id="sectionCount_'+response.body[i].zoneSlNo+'_'+response.body[i].sectionList[j].rackSlNo+'" class="section_counter">('
														+ response.body[i].sectionList[j].sectionCount
														+ ')</span>'
														+ '<label for="check3">&nbsp;&nbsp;<a href="javascript:void(0)"><i title="Edit Rack" id="check_'
														+ response.body[i].zoneSlNo
														+ '_'
														+ response.body[i].sectionList[j].rackSlNo
														+ '" class="ti-pencil cbicon2 checkIcon_'
														+ response.body[i].zoneSlNo
														+ ' sectionCB_'
														+ response.body[i].zoneSlNo
														+ '_'
														+ response.body[i].sectionList[j].rackSlNo
														+ '"  onclick=editSection("'
														+ response.body[i].sectionList[j].rackCode
														+ '","'
														+ response.body[i].sectionList[j].rackId
														+ '","'
														+ response.body[i].sectionList[j].zoneCode
														+ '");></i></a>&nbsp;<a href="javascript:void(0)"><i title="Delete Rack" id="check_'
														+ response.body[i].zoneSlNo
														+ '_'
														+ response.body[i].sectionList[j].rackSlNo
														+ '" class="ti-close cbicon2 checkIcon_'
														+ response.body[i].zoneSlNo
														+ ' sectionCB_'
														+ response.body[i].zoneSlNo
														+ '_'
														+ response.body[i].sectionList[j].rackSlNo
														+ '" onclick=removeSection("'
														+ response.body[i].sectionList[j].rackSlNo
														+ '","'
														+ response.body[i].sectionList[j].rackId
														+ '","'
														+ response.body[i].zoneSlNo
														+ '");></i></a></label></li>';
											}
										}
									 
									 
									var tbl = '<li id="zoneLI_'+response.body[i].zoneSlNo+'"><span class="caret" id="spanRack_'
											+ response.body[i].zoneSlNo
											+ '" onclick=showRack("'
											+ response.body[i].zoneSlNo
											+ '") value="0"></span> <div class="cfloor" id="cbfloor_'+response.body[i].zoneSlNo+'"> <input type="checkbox" id="check2_'
											+ response.body[i].zoneSlNo
											+ '" class="pc1-box" onchange=checkSection(this,"'
											+ response.body[i].zoneSlNo
											+ '","'
											+ response.body[i].zoneCode
											+ '") checked="checked"> </div> <span class="leveltxt">'
											+ response.body[i].zoneCode
											+ ' - '
											+ response.body[i].zoneName
											+ ' </span><span id="floorCount_'+response.body[i].zoneSlNo+'" class="floor_counter"> ('
											+ response.body[i].floorCount
											+ ')</span>'
											+ '<label for="check2">&nbsp;&nbsp;<a href="javascript:void(0)"><i title="Add Rack" id="" class="ti-plus cbicon1 checkIcon2_'
											+ response.body[i].zoneSlNo
											+ '" onclick=openRackNav("'
											+ response.body[i].zoneCode
											+ '","'
											+ response.body[i].zoneId
											+ '");></i></a>'
											+ '&nbsp;<a href="javascript:void(0)"><i title="Edit Zone" id="" class="ti-pencil cbicon1 checkIcon2_'
											+ response.body[i].zoneSlNo
											+ '" onclick=editFloor("'
											+ response.body[i].zoneCode
											+ '","'
											+ response.body[i].zoneId
											+ '");></i></a>&nbsp;<a href="javascript:void(0)"><i title="Delete Zone" id="" class="ti-close cbicon1 checkIcon2_'
											+ response.body[i].zoneSlNo
											+ '" value="'
											+ response.body[i].zoneId
											+ '" id="removeFloor_'
											+ response.body[i].zoneSlNo
											+ '" onclick=removeFloor("'
											+ response.body[i].zoneSlNo
											+ '","'
											+ response.body[i].zoneId
											+ '");></i></a></label>'
											+ '<ul class="nested" id="lastUl_'+response.body[i].zoneSlNo+'">'
											+ div + '</ul></li>';

									$("#liFloor").append(tbl);
										
								}

								$(".cbicon").addClass("green-cls");
								$(".cbicon1").addClass("green-cls");
								$(".cbicon2").addClass("green-cls");
								$(".cbicon").removeClass("remove-green");
								$(".cbicon1").removeClass("remove-green");
								$(".cbicon2").removeClass("remove-green");

								showRoomDetails(warehouseId);
							}
						},
						error : function(data) {
							console.log(data)
							$("#liFloor").empty();
						}
					});
		} else {
			$("#myUL").hide();
			
			$("#liFloor").empty();
			
			$(".flowsection").css("border-right","0px solid #ccc")
			$(".slidearrow").hide();
			
			$("#warehouseId").empty();

			$("#locationCode").empty();
			$('.loader').hide();
	    	$("body").removeClass("overlay");
		}

		$("#myTbl").hide();
		$(".btn-hs").hide();
		$("#demo").show();

	}
	
	function showRoomDetails(warehouseId) {
		
		var dataset = [];
		$(".pc2-box:checkbox:checked").each(function(){
			dataset.push($(this).attr("data-sec"));
		})
		console.log(dataset)
		if(dataset.length > 0) {
			$.ajax({
				type : "POST",
				url : "manage-warehouse-get-Wh-room-details",
				dataType : 'json',
				contentType : 'application/json',
				data : JSON.stringify(dataset),
				success : function(response) {
					if (response.message == "success") {
						console.log(response);
						
						if(response.body.length > 0) {
						
							$(".slidearrow").show();
						} else {
						
							$(".slidearrow").hide();
						}
						
						$(".roomListDiv").empty();
						var act_cls = 0;
						$(".roombtn").removeClass("roombtnactive");
						
						var locCount = 0;
						
						for(var i = 0; i < response.body.length; i++) {
							
							locCount = locCount + response.body[i].roomCount;
							
							var floorCount = 0;
							
							if(response.body[i].floorCount != null) {
								floorCount = response.body[i].floorCount;
								
							}
							
							
							var div = "";
							if(response.body[i].roomList.length > 0) {
								for(var j = 0; j < response.body[i].roomList.length; j++) {
									var sec_room = i+'_'+j;
									var secId = response.body[i].roomList[j].rackId;
									var rmId = response.body[i].roomList[j].roomId;
									var rmCode = response.body[i].roomList[j].roomCode;
									var rmName = response.body[i].roomList[j].roomName;
									var rmType = response.body[i].roomList[j].roomType;
									var secCode = response.body[i].roomList[j].rackCode;
									var zoneCode = response.body[i].roomList[j].zoneCode;
									var zoneSlNo = response.body[i].roomList[j].zoneSlNo;
									var rackSlNo = response.body[i].roomList[j].rackSlNO;
									
									var textLen = response.body[i].roomList[j].roomName.length;
									
									var dycls = i+"_"+j;
									
									
									if(j == 0 && act_cls == 0) {
										if(textLen > 7) {
											
													div = div
															+ '<div title="Edit Bin" id="'
															+ i
															+ '_'
															+ j
															+ '" class="roombtn roombtnactive cp fs-12"  rmName="'
															+ rmName
															+ '" onclick=openNav("'
															+ response.body[i].roomList[j].rackId
															+ '","'
															+ response.body[i].roomList[j].rackCode
															+ '","'
															+ response.body[i].roomList[j].zoneCode
															+ '");activeRoom("'
															+ sec_room
															+ '","'
															+ secId
															+ '","'
															+ rmId
															+ '","'
															+ rmCode
															+ '","'
															+ rmType
															+ '","'
															+ secCode
															+ '","'
															+ zoneCode
															+ '",'
															+ zoneSlNo
															+ ','
															+ rackSlNo
															+ ');>'
															+ response.body[i].roomList[j].roomName
															+ '</div>';
												} else {
													div = div
															+ '<div title="Edit Bin" id="'
															+ i
															+ '_'
															+ j
															+ '" class="roombtn roombtnactive cp " rmName="'
															+ rmName
															+ '" onclick=openNav("'
															+ response.body[i].roomList[j].rackId
															+ '","'
															+ response.body[i].roomList[j].rackCode
															+ '","'
															+ response.body[i].roomList[j].zoneCode
															+ '");activeRoom("'
															+ sec_room
															+ '","'
															+ secId
															+ '","'
															+ rmId
															+ '","'
															+ rmCode
															+ '","'
															+ rmType
															+ '","'
															+ secCode
															+ '","'
															+ zoneCode
															+ '",'
															+ zoneSlNo
															+ ','
															+ rackSlNo
															+ ');>'
															+ response.body[i].roomList[j].roomName
															+ '</div>';
												}

												act_cls = 1;
												var onclickattr = 'openNav("'
														+ response.body[i].roomList[j].rackId
														+ '","'
														+ response.body[i].roomList[j].rackCode
														+ '","'
														+ response.body[i].roomList[j].zoneCode
														+ '");activeRoom("'
														+ sec_room + '","'
														+ secId + '","' + rmId
														+ '","' + rmCode
														+ '","' + rmType
														+ '","' + secCode
														+ '","' + zoneCode
														+ '");';
												$(".slidearrow").attr(
														"onclick", "");
												$(".slidearrow").attr(
														"onclick", onclickattr);

											} else {
												if (textLen > 7) {
													div = div
															+ '<div title="Edit Bin" id="'
															+ i
															+ '_'
															+ j
															+ '" rmName="'
															+ rmName
															+ '" class="roombtn cp fs-12" onclick=openNav("'
															+ response.body[i].roomList[j].rackId
															+ '","'
															+ response.body[i].roomList[j].rackCode
															+ '","'
															+ response.body[i].roomList[j].zoneCode
															+ '");activeRoom("'
															+ sec_room
															+ '","'
															+ secId
															+ '","'
															+ rmId
															+ '","'
															+ rmCode
															+ '","'
															+ rmType
															+ '","'
															+ secCode
															+ '","'
															+ zoneCode
															+ '",'
															+ zoneSlNo
															+ ','
															+ rackSlNo
															+ ');>'
															+ response.body[i].roomList[j].roomName
															+ '</div>';
												} else {
													div = div
															+ '<div title="Edit Bin" id="'
															+ i
															+ '_'
															+ j
															+ '" rmName="'
															+ rmName
															+ '" class="roombtn cp " onclick=openNav("'
															+ response.body[i].roomList[j].rackId
															+ '","'
															+ response.body[i].roomList[j].rackCode
															+ '","'
															+ response.body[i].roomList[j].zoneCode
															+ '");activeRoom("'
															+ sec_room
															+ '","'
															+ secId
															+ '","'
															+ rmId
															+ '","'
															+ rmCode
															+ '","'
															+ rmType
															+ '","'
															+ secCode
															+ '","'
															+ zoneCode
															+ '",'
															+ zoneSlNo
															+ ','
															+ rackSlNo
															+ ');>'
															+ response.body[i].roomList[j].roomName
															+ '</div>';
												}
											}

										}
									}

									var tbl = '<h3 class="roomLoc roomSectionDiv_'+response.body[i].rackCode+' roomFloorDiv_'+response.body[i].zoneCode+'">'
											+ response.body[i].zoneCode
											+ '-'
											+ response.body[i].zoneCode
											+ '-'
											+ response.body[i].rackCode
											+ ': '
											+ response.body[i].zoneName
											+ ' - '
											+ response.body[i].rackName
											+ ' ('
											+ response.body[i].roomCount
											+ ')</h3>'
											+ '<div class="row btmgap roomLoc roomSectionDiv_'+response.body[i].rackCode+' roomFloorDiv_'+response.body[i].zoneCode+'"><div class="col-md-2" float:"right"><div class="plusbtn cp" title="Add Bin" onclick=openNav("'
											+ response.body[i].rackId
											+ '","'
											+ response.body[i].rackCode
											+ '","'
											+ response.body[i].zoneCode
											+ '")>+</div></div><div class="col-md-10 roomsection rmsec_'+response.body[i].rackCode+'">'
											+ div + '</div></div>';

									$(".roomListDiv").append(tbl);
								}

								console.log(tbl)

								

								$('.loader').hide();
								$("body").removeClass("overlay");

							}
						},
						error : function(data) {
							
							$(".roomListDiv").empty();
							//$("#locCount").text(' (0)');
							$(".section_counter").text(' (0)');

							$('.loader').hide();
							$("body").removeClass("overlay");
						}
					});
		} else {
			$(".roomListDiv").empty();

			$('.loader').hide();
			$("body").removeClass("overlay");
		}
	}

	 function checkAll(e) {
		var checkboxes = document.getElementsByName('listCheck');

		if (e.checked) {
			for (var i = 0; i < checkboxes.length; i++) {
				checkboxes[i].checked = true;
			}
		} else {
			for (var i = 0; i < checkboxes.length; i++) {
				checkboxes[i].checked = false;
			}
		}

	}

	function checkSection(e, slNo, fCode) {
		var checkboxes = document.getElementsByClassName('check_' + slNo);

		if (e.checked) {

			for (var i = 0; i < checkboxes.length; i++) {
				checkboxes[i].checked = true;
			}
			$(".checkIcon2_" + slNo).addClass("green-cls");
			$(".checkIcon_" + slNo).addClass("green-cls");
			$(".checkIcon2_" + slNo).removeClass("remove-green");
			$(".checkIcon_" + slNo).removeClass("remove-green");

			$(".cfloor").removeClass("checkboxinact");
			$("#cbLoc").removeClass("checkboxinact");

			//$(".roomFloorDiv_"+fCode).show();
		} else {
			for (var i = 0; i < checkboxes.length; i++) {
				checkboxes[i].checked = false;
			}
			$(".checkIcon2_" + slNo).removeClass("green-cls");
			$(".checkIcon_" + slNo).removeClass("green-cls");
			$(".checkIcon2_" + slNo).addClass("remove-green");
			$(".checkIcon_" + slNo).addClass("remove-green");

			//$(".roomFloorDiv_"+fCode).hide();
		}

		var cb = document.getElementsByClassName('pc1-box');
		var chkLength = cb.length;
		var c = 0;
		$(".pc1-box:checkbox:checked").each(function() {
			c = c + 1;
		})

		if (chkLength != c) {
			$("#cbLoc").addClass("checkboxinact");
		} else {
			$("#cbLoc").removeClass("checkboxinact");
		}

		showRoomDetails("ABC");
	}
	function checkSec(e, slNo, j, secCode) {
		var checkboxes = document.getElementsByName('check_' + slNo + '_' + j);

		var cb = document.getElementsByClassName('check_' + slNo);

		var chkLength = cb.length;

		var c = 0;
		$(".check_" + slNo + ":checkbox:checked").each(function() {
			c = c + 1;
		})

		if (e.checked) {
			$(".sectionCB_" + slNo + "_" + j).addClass("green-cls");
			$(".sectionCB_" + slNo + "_" + j).removeClass("remove-green");
		} else {
			$(".sectionCB_" + slNo + "_" + j).removeClass("green-cls");
			$(".sectionCB_" + slNo + "_" + j).addClass("remove-green");

		}

		if (chkLength != c) {
			$("#cbfloor_" + slNo).addClass("checkboxinact");
			$("#cbLoc").addClass("checkboxinact");
		} else {
			$("#cbfloor_" + slNo).removeClass("checkboxinact");
			$("#cbLoc").removeClass("checkboxinact");
		}

		showRoomDetails("ABC");
	}
	function deleteFloor() {
		var id = $("#ZoneDBVal").val();
		var i = $("#ZoneSlNoDBVal").val();
		if (i && id) {
			removeFloor(i, id);
		}
	}

	function deleteRack() {
		var id = $("#rackDBVal").val();
		var i = $("#rackSerialNo").val();
		var fSlNo = $("#zoneSerialNo").val();
		if (i && id && fSlNo) {
			removeSection(i, id, fSlNo);
		}
	}
	function removeFloor(i, id) {

		$("#deleteModalBtn").attr("value", "");
		$("#deleteModalBtn").attr("slNo", "");
		$("#deleteModalBtn").attr("deleteData", "");
		$("#delete").modal('show');
		$("#deleteModalBtn").attr("value", id);
		$("#deleteModalBtn").attr("slNo", i);
		$("#deleteModalBtn").attr("deleteData", "1");
		//$("#floorLI_"+i).remove();
	}

	function removeSection(i, id, fSlNo) {
		$("#deleteModalBtn").attr("value", "");
		$("#deleteModalBtn").attr("slNo", "");
		$("#deleteModalBtn").attr("deleteData", "");
		$("#deleteModalBtn").attr("zoneSlNo", "");
		$("#delete").modal('show');
		$("#deleteModalBtn").attr("value", id);
		$("#deleteModalBtn").attr("slNo", i);
		$("#deleteModalBtn").attr("deleteData", "2");
		$("#deleteModalBtn").attr("zoneSlNo", fSlNo);
	}

	function cancelModalBtn() {
		$("#deleteModalBtn").attr("value", "");
		$("#deleteModalBtn").attr("slNo", "");
		$("#deleteModalBtn").attr("deleteData", "");
		$("#deleteModalBtn").attr("zoneSlNo", "");
		$("#deleteModalBtn").removeAttr("disabled");
	}

	function deleteRoom(id, fNo, sNo) {
		$("#deleteModalBtn").attr("value", "");
		$("#deleteModalBtn").attr("slNo", "");
		$("#deleteModalBtn").attr("deleteData", "");
		$("#deleteModalBtn").attr("zoneSlNo", "");
		$("#delete").modal('show');
		$("#deleteModalBtn").attr("value", id);
		$("#deleteModalBtn").attr("deleteData", "3");
		$("#deleteModalBtn").attr("zoneSlNo", fNo);
		$("#deleteModalBtn").attr("slNo", sNo);
	}
	
	function showRack(i) {
		var value = $("#spanRack_" + i).attr('value');
		if (value == "0") {
			$("#lastUl_" + i).addClass("active");
			$("#spanRack_" + i).addClass("caret-down");
			$("#spanRack_" + i).attr('value', '1');
		} else {
			$("#lastUl_" + i).removeClass("active");
			$("#spanRack_" + i).removeClass("caret-down");
			$("#spanRack_" + i).attr('value', '0');
		}

	}

	function submitRack(dataset) {
		console.log(dataset)
		$.ajax({
					type : "POST",
					url : "manage-warehouse-save-rack",
					dataType : "json",
					contentType : "application/json",
					data : JSON.stringify(dataset),
					success : function(response) {
						if (response.message == "Success") {
							
							console.log(response.body)
							var tbl = '<li id="rackLI_'+response.body.zoneSlNo+'_'+response.body.rackSlNo+'"><span class="caret-remove"></span><input type="checkbox" id="sectionChkBox" name="check_'
									+ response.body.zoneSlNo
									+ '_'
									+ response.body.rackSlNo
									+ '" onchange=checkSec(this,"'
									+ response.body.zoneSlNo
									+ '","'
									+ response.body.rackSlNo
									+ '","'
									+ response.body.rackCode
									+ '") class="pc2-box check_'
									+ response.body.zoneSlNo
									+ '" checked="checked" data-sec="'
									+ response.body.rackId
									+ '" data-floor="'
									+ response.body.zoneId
									+ '" data-loc="'
									+ response.body.warehouseId
									+ '"> <span class="leveltxt">'
									+ response.body.rackCode
									+ ' - '
									+ response.body.rackName
									+ '</span><span id="sectionCount_'+response.body.zoneSlNo+'_'+response.body.rackSlNo+'" class="section_counter"> (0) </span>'
									+ '<label for="check3">&nbsp;&nbsp;<a href="javascript:void(0)"><i title="Edit Rack" id="check_'
									+ response.body.zoneSlNo
									+ '_'
									+ response.body.rackSlNo
									+ '" class="ti-pencil cbicon2 checkIcon_'
									+ response.body.zoneSlNo
									+ ' sectionCB_'
									+ response.body.zoneSlNo
									+ '_'
									+ response.body.rackSlNo
									+ '" onclick=editSection("'
									+ response.body.rackCode
									+ '","'
									+ response.body.rackId
									+ '","'
									+ response.body.locationCode
									+ '");></i></a>&nbsp;<a href="javascript:void(0)"><i title="Delete Rack" id="check_'
									+ response.body.zoneSlNo
									+ '_'
									+ response.body.rackSlNo
									+ '" class="ti-close cbicon2 checkIcon_'
									+ response.body.zoneSlNo
									+ ' sectionCB_'
									+ response.body.zoneSlNo
									+ '_'
									+ response.body.rackSlNo
									+ '" onclick=removeSection("'
									+ response.body.rackSlNo
									+ '","'
									+ response.body.rackId
									+ '","'
									+ response.body.zoneSlNo
									+ '");></i></a></label></li>';

							var rackDBVal = $("#rackDBVal").val();

							if (rackDBVal) {
								openDetails(response.body.warehouseId);
							} else {
								console.log("add rack")
								
								$("#lastUl_" + response.body.zoneSlNo).append(
										tbl);
								$(
										".sectionCB_" + response.body.zoneSlNo
												+ "_" + response.body.rackSlNo)
										.addClass("green-cls");
								$(
										".sectionCB_" + response.body.zoneSlNo
												+ "_" + response.body.rackSlNo)
										.removeClass("remove-green");

								$("#lastUl_" + response.body.zoneSlNo)
										.addClass("active");
								$("#spanRack_" + response.body.zoneSlNo)
										.addClass("caret-down");
								$("#spanRack_" + response.body.zoneSlNo).attr(
										'value', '1');
							}

							closeRackNav();
							showRoomDetails(response.body.warehouseId);
							//alert(response.body.warehouseId)
						} else {
							$('.loader').hide();
							$("body").removeClass("overlay");
						}
					},
					error : function(data) {
						console.log(data);
						$('.loader').hide();
						$("body").removeClass("overlay");
					}
				})
	}
	 
	function editSection(i, id, fCode) {
		$("#rackDBVal").val("");
		$("#rackDBVal").val(id);
		var rackNavText = $("#locationCode").val();
		
		rackNavText = rackNavText + "-" + fCode + "-" + i;
		//alert(rackNavText)
		$("#rackNavText").text("");
		$("#rackNavText").text(rackNavText);
		document.getElementById("mySidenavRack").style.cssText = "width: 270px; position: absolute; right:-37px; overflow: hidden;";
		document.getElementById("main").style.width = "420px";

		closeZoneNav();
		closeNav();

		if (id) {
			$.ajax({
				type : "POST",
				url : "manage-warehouse-rack-edit",
				dataType : 'json',
				contentType : 'application/json',
				data : id,
				success : function(response) {
					if (response.message == "success") {
						$("#rackId").val(response.body.rackCode);
						$("#rackName").val(response.body.rackName);
						$("#zoneRack").val(response.body.zoneId);
						$("#zoneSerialNo").val(response.body.zoneSlNo);
						$("#rackSerialNo").val(response.body.rackSlNo);
					}
				},
				error : function(data) {
					console.log(data)
				}
			});
		}
	}

	function submitRoom(dataset) {
		console.log(dataset)
		$
				.ajax({
					type : "POST",
					url : "manage-warehouse-save-room",
					dataType : "json",
					contentType : "application/json",
					data : JSON.stringify(dataset),
					success : function(response) {
						if (response.message == "Success") {
							console.log(response)
							var roomDBId = $("#roomDBId").val();

							if (roomDBId == null || roomDBId == "") {
								var loccount = $("#locCount").text();
								//alert("v"+$("#locCount").text())
								loccount = loccount.trim();
								loccount = loccount.replace("(", "");
								loccount = loccount.replace(")", "");

								loccount = parseFloat(loccount) + 1;

								$("#locCount").text(" (" + loccount + ")");
								//alert("c"+loccount)
								
								var floorCount = $(
										"#floorCount_" + response.body.zoneSlNo)
										.text();
								floorCount = floorCount.trim();
								floorCount = floorCount.replace("(", "");
								floorCount = floorCount.replace(")", "");

								floorCount = parseFloat(floorCount) + 1;

								$("#floorCount_" + response.body.zoneSlNo)
										.text(" (" + floorCount + ")");

								var sectionCount = $(
										"#sectionCount_"
												+ response.body.zoneSlNo + "_"
												+ response.body.rackSlNO)
										.text();
								sectionCount = sectionCount.trim();
								sectionCount = sectionCount.replace("(", "");
								sectionCount = sectionCount.replace(")", "");

								sectionCount = parseFloat(sectionCount) + 1;

								$(
										"#sectionCount_"
												+ response.body.zoneSlNo + "_"
												+ response.body.rackSlNO).text(
										" (" + sectionCount + ")");
							}


							showRoomDetails(response.body.warehouseId);
							
							closeNav();

						} else {
							$('.loader').hide();
							$("body").removeClass("overlay");
						}
					},
					error : function(data) {
						console.log(data);
						$('.loader').hide();
						$("body").removeClass("overlay");
					}
				})
	}
</script>
</head>
<body>
	<div layout:fragment="content" class="maincontent">

		<div class="container-fluid">
			<div class="row">
				<div class="maincontentsec">
					<div class="content_padding">
						<div class="row">
							<div class="col-md-9"></div>
							<div class="col-md-1">
								<button class="btn2" id="ranking">Ranking</button>
							</div>
							<div class="col-md-2">
								<button class="btn4">Cancel</button>
								<button class="btn1">Save</button>
							</div>
						</div>
						<div class="row">
							<div class="col-md-1">
								<label>Warehouse</label>
							</div>
							<div class="col-md-3">
								<!-- <div class="selectbox"> -->
								<select class="form-control" th:id="warehouseId"
									style="height: 30px" onchange="openDetails(this.id)">
									<option>--Select--</option>
									<option th:each="c:${locationList}" th:value='${c.key}'
										th:text="${c.name}" th:name='${c.name}'
										th:selected="${c.key==locationList}"></option>
								</select>
								<!-- </div> -->
							</div>
							<div class="col-md-3">
								<label>Location ID</label>&nbsp;&nbsp;<span th:id="locationId"
									class="datatxt"></span>
							</div>

							<div class="col-md-3">
								<label>Location Code</label>&nbsp;&nbsp;<span
									th:id="locationCode" class="datatxt"></span>
							</div>

						</div>


						<div class="row">
							<div class="col-md-12">
								<div class="headingbar">
									<a href="#" data-toggle="collapse" data-target="#demo_11"
										style="color: #333; text-decoration: none;">Layout</a> <a
										href="#" data-toggle="collapse" data-target="#demo_11"
										style="float: right; color: #333; text-decoration: none;"><i
										class="ti-angle-down"></i></a>
								</div>
							</div>
						</div>
						<div id="demo_11">
							<!-- show -->
							<div class="row">
								<div class="col-md-4 layout-header">
									<div class="level_breadcrumb">
										Location <i class="ti-arrow-right"></i> Zone <i
											class="ti-arrow-right"></i> Rack <i class="ti-arrow-right"></i> Bin
									</div>
								
										<div class="flowsection">
										<!-- code start for second tree -->
											<ul id="#myUL" class="level">
												<li><span class="caret"></span>
												<div id="cbLoc">
												<input type="checkbox" id="check1" class="pc-box" checked="checked">
												</div> <span id="warehouseDetailsId" class="leveltxt"></span><span
																id="locCount" class="level_counter"></span> <label
													for="check1">&nbsp;&nbsp;<a 
													href="javascript:void(0)"><i title="Add Zone" 
													 class="ti-plus cbicon" onclick="openZoneNav();"></i></a> </label>
													<ul class="nested" id="liFloor">

													
													</ul></li>
											</ul>
											<!-- code end for second tree -->
										</div>
									</div>
									<!-- code end for second tree -->


							<div class="col-md-8">
								<div class="roomdetails roomListDiv" id="main"></div>
								<div class="slidearrow" onclick="openNav('','','')">
									<i class="ti-arrow-left"></i>
								</div>
								<!-- code start for Bin -->	
									<div id="mySidenav" class="sidenav">
										<div class="slidebox">
											<div class="row">
												<div class="col-md-10">
													<div class="edit" id="roomLevelText"></div>
												</div>
												<div class="col-md-2">
													<div class="arrow">
														<a href="javascript:void(0)" class="closebtn"
															onclick="closeNav()"><i class="ti-arrow-right"></i></a>
													</div>
												</div>
												<div class="chartbtnsec">
													<div align="right">
														<button class="btn4" onclick="closeNav()">CANCEL</button>
														<button class="btn3" id="dltRoom" onclick="deleteRoom()">DELETE</button>
														<button class="btn1" id="roomSave">SAVE</button>
													</div>
												</div>
												<div class="col-md-12">
													<div class="form-group">
														<label>Code</label> <input type="text"
															class="form-control transparenttxtbox"
															placeholder="Room Code" id="roomCode"> <input
															type="hidden" id="sectionRoomId"> <input
															type="hidden" id="roomDBId"> <input type="hidden"
															id="rFloorSlNo"> <input type="hidden"
															id="rSectionSlNo">
													</div>
												</div>
												<div class="col-md-12">
													<div class="form-group">
														<label>Name</label> <input type="text"
															class="form-control transparenttxtbox"
															placeholder="Room Name" id="roomName"
															onblur="checkCharLengthOfString('roomName','10');">
													</div>
												</div>
												<div class="col-md-12">
													<div class="form-group">
														<label>Room Type</label>
														<input type="text"
															class="form-control transparenttxtbox"
															placeholder="Bin Type" id="roomType">
													</div>
												</div>
											</div>
										</div>
									</div>
								<!-- code end for Bin -->		
									<!-- code for zone entry 1st main + -->
									<div id="mySidenavZone" class="sidenav">
										<div class="slidebox">
											<div class="row">
												<div class="col-md-10">
													<div class="edit" id="zoneNavText"></div>
												</div>
												<div class="col-md-2">
													<div class="arrow">
														<a href="javascript:void(0)" class="closebtn"
															onclick="closeZoneNav()"><i class="ti-arrow-right"></i></a>
													</div>
												</div>

												<div class="chartbtnsec">
													<div class="row">
														<button class="btn4" onclick="closeZoneNav()">CANCEL</button>
														<button class="btn3" onclick="deleteFloor()">DELETE</button>
														<button class="btn1" id="zoneSave">SAVE</button>
													</div>
												</div>
												<div class="col-md-12 mt-15">
													<div class="form-group">
														<label>ID</label> <input type="text"
															class="form-control transparenttxtbox" id="zoneId"
															placeholder=Number> <input type="hidden"
															id="zoneDBVal"> <input type="hidden"
															id="zoneSlNoDBVal">
													</div>
												</div>

												<div class="col-md-12 mt-15">
													<div class="form-group">
														<label>Name</label> <input type="text" id="zoneName"
															class="form-control transparenttxtbox" placeholder=Zone>
													</div>
												</div>

											</div>
										</div>
									</div>
									
									<!-- code for zone entry end -->
								<!-- code for rack entry start -->
								<!-- Add Rack -->
								<div id="mySidenavRack" class="sidenav">
									<div class="slidebox">
										<div class="row">
											<div class="col-md-10">
												<div class="edit" id="rackNavText">Rack</div>
											</div>
											<div class="col-md-2">
												<div class="arrow">
													<a href="javascript:void(0)" class="closebtn"
														onclick="closeRackNav()"><i class="ti-arrow-right"></i></a>
												</div>
											</div>
											<div class="chartbtnsec">
												<div class="row">
													<button class="btn4" onclick="closeRackNav()">CANCEL</button>
													<button class="btn3" onclick="deleteRack()">DELETE</button>
													<button class="btn1" id="rackSave">SAVE</button>
												</div>
											</div>
											<div class="col-md-12">
												<div class="form-group">
													<label>Code</label> <input type="text" id="rackId"
														class="form-control transparenttxtbox" placeholder="Code">
													<input type="hidden" id="rackDBVal"> <input
														type="hidden" id="zoneRack"> <input type="hidden"
														id="zoneSerialNo"> <input type="hidden"
														id="rackSerialNo">
												</div>
											</div>
											<div class="col-md-12">
												<div class="form-group">
													<label>Name</label> <input type="text"
														class="form-control transparenttxtbox"
														placeholder="Rack Name" id="rackName">
												</div>
											</div>
										</div>
									</div>
								</div>
								<!-- code for rack entry  end -->
							</div>

						</div>

					</div>


				</div>
				<!-- HR DETAILS PART END -->

			</div>
		</div>
		<!-- Modal Start-->
		<!-- 	<div id="myModal" class="modal fade" role="dialog">
		<div class="modal-dialog">
			Modal content
			<div class="modal-content" style="width: 750px;">
				<div class="modal-header">
					<h4 class="modal-title">Bin Ranking:Chicago WareHouse</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				<div class="modal-body">
					<table style="width: 100%; border: 0;" id="table1">
					</table>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div> -->
		<div class="modal fade" id="myModal">
			<div class="modal-dialog modal-lg" style="max-width: 1100px">
				<div class="modal-content" style="width: 100%">

					<!-- Modal Header -->
					<div class="modal-header">
						<h4 class="modal-title" style="font-size: 16px">
							<b>Bin Ranking:Chicago WareHouse</b>
						</h4>
						<button type="button" class="close" data-dismiss="modal"
							style="font-size: 25px">×</button>
					</div>
					<!-- Modal body -->
					<div class="modal-body" style="height: 600px; overflow-y: scroll;">
						<div class="row">
							<div class="col-md-12 mrt_btm" align="right">
								<button class="btn3">AutoBank</button>
								<button class="btn1">Save</button>
								<button class="btn4">Cancel</button>
							</div>
						</div>
						<div class="vertical-line">


							<div class="row">
								<div class="col-md-12">
									<table class="newtbl">
										<thead>
											<tr>
												<th align="center">Rank</th>
												<th align="center">Code</th>
												<th align="center">Name</th>
												<th align="center">Bin or storage</th>
												<th align="center">Type</th>
												<th align="center">Dimensions</th>
												<th align="center">Volume</th>
												<th align="center">Max weight</th>

											</tr>
										</thead>
										<tbody>
											<tr>
												<td align="center">1</td>
												<td align="left">CW-B-10-1-101</td>
												<td align="center">Zone A- Rack- 10 Floor- 1 Bin- 101</td>
												<td align="left">Bin</td>
												<td align="left">Damage</td>
												<td align="left">6 * 10 * 18</td>
												<td align="center">1080</td>
												<td align="right">300</td>

											</tr>
										</tbody>
									</table>
								</div>
							</div>


						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- Modal End-->
	</div>
	<div id="delete" class="modal fade show" aria-modal="true">
		<div class="modal-dialog modal-confirm">
			<div class="modal-content">
				<div class="modal-header flex-column">
					<div class="icon-box">
						<i class="ti-close"></i>
					</div>
					<h4 class="modal-title w-100">Are you sure?</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-hidden="true" onclick="cancelModalBtn()">
						<i class="ti-close modal-close"></i>
					</button>
				</div>
				<div class="modal-body">
					<p>Do you really want to delete these records? This process
						cannot be undone.</p>
				</div>
				<div class="modal-footer justify-content-center">
					<button type="button" class="btn1" data-dismiss="modal"
						onclick="cancelModalBtn();">Cancel</button>
					<button type="button" class="btn3" id="deleteModalBtn">Delete</button>
					<!-- <img src="../assets/gif/loader.gif">  -->
				</div>
			</div>
		</div>
	</div>
	</div>

</body>
</html>